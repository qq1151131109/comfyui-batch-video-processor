# 📹 批量视频处理器 (Batch Video Processor)

一个专为ComfyUI设计的强大视频批处理扩展，提供完整的视频生产流水线，从素材管理到最终输出的一站式解决方案。

## 🚀 功能特色

- **📁 智能素材管理** - 批量上传、自动分类、格式识别
- **🎬 专业视频处理** - 切分、拼接、裁剪、格式转换
- **🤖 AI智能增强** - LLM文案生成、TTS语音合成、OCR识别
- **📱 平台优化** - TikTok格式转换、抖音规格适配
- **⚡ 高性能处理** - 多线程并发、FFmpeg优化、GPU加速

---

## 📋 节点详细说明

### 🎬 批量素材加载器 (BatchVideoLoader)
**功能：** 批量上传和管理各种格式的多媒体素材
- **支持格式：** 视频(.mp4, .avi, .mov, .mkv等)、音频(.mp3, .wav, .aac等)、图片(.jpg, .png等)
- **核心特性：**
  - 📂 最多支持20个文件夹同时上传
  - 🔍 自动文件格式检测和分类
  - 📊 实时显示文件数量和大小统计
  - 🏷️ 智能文件命名和索引
- **适用场景：** 项目初始化、素材整理、批量导入

---

### 🖼️ 视频画面拼接器 (BatchVideoComposer)
**功能：** 将多个视频在同一画面中进行空间布局组合
- **布局选项：** 
  - 🔲 2x2网格布局（4个视频）
  - ➡️ 1x4横向排列
  - ⬇️ 4x1纵向排列
  - 🎯 自定义布局模式
- **高级功能：**
  - 🎨 边框和间距控制
  - 🏷️ 视频标题叠加
  - ⚖️ 智能分辨率适配
  - 🎵 音频混合处理
- **适用场景：** 对比视频制作、多视角展示、监控画面合成

---

### ✂️ 批量视频切分器 (BatchVideoCutter)
**功能：** 按照固定时长将长视频精确切分为多个片段
- **切分模式：**
  - ⏱️ 固定时长切分（如每30秒一段）
  - 📏 固定段数切分（如分成10段）
  - 🎯 关键帧切分（避免画面跳跃）
- **智能优化：**
  - 🔄 自动跳过过短片段
  - 🎬 保持原始质量
  - 📝 批量重命名输出
- **适用场景：** 长视频分片、短视频制作、内容切片

---

### 🔲 批量视频裁剪器 (BatchVideoCropper)
**功能：** 智能裁剪视频画面，支持横屏转竖屏等比例调整
- **裁剪功能：**
  - 📱 横屏→竖屏转换（16:9→9:16）
  - 🎯 智能居中裁剪
  - 👁️ 实时预览效果
  - ⚖️ 保持宽高比选项
- **批处理能力：**
  - 📁 整个文件夹批量处理
  - 🏷️ 统一命名规则
  - 🎨 添加黑边填充选项
- **适用场景：** 抖音视频制作、手机端适配、画面重构

---

### 📱 TikTok格式转换器 (VideoNormalizer)
**功能：** 将视频标准化为TikTok/抖音平台的最佳格式
- **标准规格：**
  - 📏 分辨率：720x1280 (9:16)
  - 🎬 帧率：30fps
  - 🎵 音频：AAC编码，48kHz
  - 📦 容器：MP4格式
- **优化特性：**
  - ⚡ 文件大小优化
  - 🎨 颜色空间校正
  - 🔊 音量标准化
  - 📱 移动端兼容性
- **适用场景：** 短视频发布、平台适配、格式统一

---

### 🎲 智能视频拼接器 (TraverseVideoConcatenator)
**功能：** 智能选择和拼接多个文件夹中的视频片段
- **拼接策略：**
  - 🎯 主文件夹遍历（确保覆盖所有素材）
  - 🎲 其他文件夹随机选择
  - ⏱️ 智能时长控制
  - 🔄 避免重复选择
- **高级功能：**
  - 🎵 音频淡入淡出
  - 🎨 场景转换效果
  - 📊 时长平衡优化
- **适用场景：** 混剪视频制作、素材整合、自动化剪辑

---

### 📥 批量视频下载器 (BatchVideoDownloader)
**功能：** 将处理完成的视频批量打包下载
- **打包功能：**
  - 📦 ZIP格式压缩
  - 📂 保持文件夹结构
  - 🏷️ 自动生成清单文件
  - 📊 包含处理统计信息
- **便捷特性：**
  - ⬇️ 一键下载所有结果
  - 🔗 直接下载链接
  - 📝 处理日志包含
- **适用场景：** 项目交付、结果归档、批量导出

---

### ⚡ 卡顿修复器 (VideoStaticCleaner)
**功能：** 自动检测并移除视频中的卡帧、静止片段
- **检测算法：**
  - 🎬 帧间差异分析
  - 📊 运动向量检测
  - 🎯 静止阈值可调
  - ⏱️ 最短保留时长设置
- **处理效果：**
  - ⚡ 提升视频流畅度
  - 📉 减少文件大小
  - 🎬 改善观看体验
  - 📊 生成清理报告
- **适用场景：** 录屏优化、直播素材处理、卡顿修复

---

### 🏆 游戏高光提取器 (GameHighlightExtractor)
**功能：** 基于游戏界面识别自动提取完整游戏局次
- **识别技术：**
  - 🎮 游戏开始/结束界面模板匹配
  - 🔤 OCR文字识别（如"游戏开始"、"VICTORY"）
  - 🎯 多种游戏支持
  - ⚙️ 自定义模板训练
- **智能提取：**
  - 🏁 完整局次捕获
  - ⏱️ 精确时间点定位
  - 🎬 自动剪辑生成
- **适用场景：** 游戏录像处理、高光集锦制作、电竞内容

---

### 🖼️ 视频缩略图生成器 (VideoThumbnailGenerator)
**功能：** 智能选择精彩帧生成视频封面缩略图
- **智能选帧：**
  - 🎯 画面清晰度分析
  - 🌈 色彩丰富度评估
  - 👥 人脸检测优先
  - 📊 避免纯色画面
- **封面设计：**
  - 🎨 文字标题叠加
  - 🌈 渐变背景效果
  - 🏷️ 统一模板应用
  - 📏 多尺寸适配
- **适用场景：** 视频封面制作、缩略图优化、内容预览

---

### 🤖 批量LLM文案生成器 (BatchLLMGenerator)
**功能：** 基于大语言模型为视频批量生成文案内容
- **文案类型：**
  - 📝 视频标题生成
  - 📄 视频描述撰写
  - 🏷️ 标签关键词提取
  - 💬 评论互动文案
- **AI能力：**
  - 🎯 根据视频内容定制
  - 📊 SEO优化建议
  - 🎨 多种文案风格
  - 📱 平台特色适配
- **适用场景：** 内容运营、批量发布、文案创作

---

### 🎤 批量TTS语音生成器 (BatchTTSGenerator)
**功能：** 将文字批量转换为自然语音，支持多种声音模型
- **语音合成：**
  - 🗣️ 多种声音选择（男声/女声/童声）
  - 🎵 情感控制（开心/沉稳/活泼）
  - 🌍 多语言支持
  - ⚙️ 语速音调调节
- **高级功能：**
  - 🎬 与视频时长匹配
  - 🎵 背景音乐混合
  - 📊 音量自动平衡
- **适用场景：** 解说视频制作、多语言配音、有声内容

---

### 🎧 音频时长匹配器 (SmartVideoCutterWithAudio)
**功能：** 根据音频文件时长智能裁切视频并融合音频
- **智能匹配：**
  - ⏱️ 音频时长自动检测
  - ✂️ 视频精确裁切
  - 🎵 音频直接融合
  - 🔄 一一对应处理
- **处理优势：**
  - 🎯 完美时长匹配
  - 🎵 无缝音频融合
  - 🚫 跳过过短视频
  - ⚖️ 音频混合控制
- **适用场景：** 音乐视频制作、配音同步、时长统一

---

## 🔧 系统要求

### 环境依赖
- **Python:** >= 3.8
- **ComfyUI:** 最新版本
- **FFmpeg:** 系统已安装
- **GPU:** CUDA支持（推荐）

### Python包依赖
```txt
ffmpeg-python>=0.2.0
opencv-python>=4.5.0
Pillow>=8.0.0
imagehash>=4.3.0
easyocr>=1.6.0
numpy>=2.2.0
```

## 📦 安装指南

### 方法1：ComfyUI-Manager安装（推荐）
1. 打开ComfyUI-Manager
2. 搜索"batch_video_processor"
3. 点击安装并重启ComfyUI

### 方法2：手动安装
```bash
cd ComfyUI/custom_nodes
git clone https://github.com/your-repo/batch_video_processor.git
cd batch_video_processor
pip install -r requirements.txt
```

## 🎯 使用场景

### 📱 短视频批量制作
1. **素材管理** → 批量素材加载器
2. **格式转换** → TikTok格式转换器  
3. **内容优化** → 卡顿修复器
4. **封面制作** → 视频缩略图生成器
5. **文案生成** → 批量LLM文案生成器
6. **批量导出** → 批量视频下载器

### 🎮 游戏内容制作
1. **录像上传** → 批量素材加载器
2. **高光提取** → 游戏高光提取器
3. **多视角合成** → 视频画面拼接器
4. **解说配音** → 批量TTS语音生成器

### 🎬 专业视频制作
1. **素材整理** → 批量素材加载器
2. **智能剪辑** → 智能视频拼接器
3. **画面裁剪** → 批量视频裁剪器
4. **音画同步** → 音频时长匹配器
5. **批量处理** → 所有节点组合使用

## 💡 工作流程建议

### 基础工作流
```
批量素材加载器 → 批量视频切分器 → TikTok格式转换器 → 批量视频下载器
```

### 高级工作流
```
批量素材加载器 → 卡顿修复器 → 视频画面拼接器 → 批量LLM文案生成器 → 批量TTS语音生成器 → 音频时长匹配器 → 批量视频下载器
```

## 🚀 性能优化

- **多线程处理：** 充分利用CPU多核
- **GPU加速：** 支持CUDA加速编码
- **内存管理：** 智能内存释放机制
- **缓存机制：** 避免重复处理

## 🤝 技术支持

- **GitHub Issues：** 问题反馈和功能请求
- **技术文档：** 详细API文档和示例
- **社区讨论：** ComfyUI社区交流

---

## 📄 更新日志

### v2.0.0 (最新)
- ✨ 新增音频时长匹配器
- 🔧 优化节点命名，更加直观易懂
- 🚀 性能提升，处理速度提高30%
- 🐛 修复多个已知问题

### v1.5.0
- ✨ 新增游戏高光提取器
- 🎨 改进缩略图生成算法
- 🔧 优化TikTok格式转换

---

*让视频批处理变得简单高效！* 🎬✨